{% extends 'usuarios/base.html' %}

{% block aba %}Visualizar estoque{% endblock %}

{% block titulo %}Visualizar estoque{% endblock %}

{% block conteudo %}
<h3>Visualização de produtos cadastrados</h3>
<hr>
<form action = "{% url 'visualizar' %}" method = "POST">
    {% csrf_token %}
    <div class = "filter">
        <label for = "nome_produto">Filtrar por produto:</label>
        <select name = "nome_produto"> {# <--- CORRIGIDO AQUI: name="nome_produto" #}
            <option value="Todos os produtos">Todos os produtos</option> {# Adicionei value para "Todos os produtos" #}
            {% for campo in lista_produtos %}
                 <option value="{{ campo.nome_produto }}">{{ campo.nome_produto }}</option> {# <-- CORRIGIDO AQUI: campo.nome_produto #}
            {% endfor %}
        </select>
        <button type = "submit" class = "btn btn-primary">Filtrar</button>
    </div>
</form>

<div class = "table-responsive">
    <table class = "table table-striped">
        <tr>
            <th>Nome do Produto</th>
            <th>Quantidade</th>
            <th>Preço de Custo</th>
            <th>Preço de Venda</th>
            <th>fornecedor</th>
        </tr>
        {% for campo in lista_produtos %} {# <-- Este loop está correto #}
            <tr>
                <td>{{ campo.nome_produto }}</td> {# <-- CORRIGIDO AQUI: campo.nome_produto #}
                <td>{{ campo.quantidade }}</td> {# <-- CORRIGIDO AQUI: campo.quantidade (assumi que o campo é 'quantidade' e não 'qtd') #}
                <td>R$ {{ campo.preco_custo }}</td> {# <-- CORRIGIDO AQUI: campo.preco_custo #}
                <td>R$ {{ campo.preco_venda }}</td> {# <-- CORRIGIDO AQUI: campo.preco_venda #}
                <td>{{ campo.fornecedor}}</td> {# <-- CORRIGIDO AQUI: campo.fornecedor #}
            </tr>
        {% empty %}
            <tr>
                <td colspan = "6">Nenhum registro encontrado.</td>
            </tr>
        {% endfor %}
    </table>
</div>
<hr>
{% endblock %}